
1介绍
阿片类药物在美国被广泛应用在治疗、管理疼痛（法律、处方用途）和用于娱乐目的（非法、非处方用途），而美国目前正在经历关于使用合成和非合成阿片类药物的国家危机，阿片
药物危机对美国民众的健康程度和美国经济的方方面面都产生了负面影响，根据阿片类药物流行病和成瘾性近几年蔓延的趋势，阿片类药物流行病可能在时间、空间、人口或其他因素
的影响下进行传播，为了更好地对阿片类流行病进行控制，我们通过对2011年到2017年五个州内各县的阿片类药物报告数量进行分析，判断阿片类药物流行病是否在进行传播、传播的
强度以及未来几年的传播趋势，所以我们需要一个模型来评估阿片类药物流行病的特征。
我们把这个问题分为三部分：
·建立一个可以描述阿片类药物流行病特征的模型
·通过分析数据检验阿片类药物流行病的传播在时间、空间维度上的相关性，并分析阿片类药物流行病的传播与其他社会经济因素的相关程度
·将模型应用于已有的数据来推测阿片类药物流行病在每个地理区域未来的发展趋势，进而制定政策对该流行病进行控制
第一，我们根据已有数据对同一地理区域内的阿片类药物报告数量与时间和空间的相关性分别进行检验，同一地理区域内的阿片类药物报告数量与时间呈现相关性，而在空间位置上
不呈现集聚性，所以我们认为，阿片类药物报告数量会随时间而推演，而地理上的距离则不会对其产生影响。
第二，我们考虑到一个地理区域（州、县）的阿片类药物报告数量会对另一个地理区域（州、县）的阿片类药物报告数量在多方面产生影响，比如贸易是否顺畅、交通是否便利等等，
我们将这些影响抽象为一个指标，称之为传播强度β。继而我们构建了一个传播矩阵来描述多个地理区域的相互影响程度，求解该模型的过程就是求解传输矩阵中每两个地理区域之间
的传播强度β的过程。
第三，我们考虑到一个地理区域（州、县）内部的社会经济因素可能会对其阿片类药物报告数量产生影响（第二问继续写，先留着）

2假设
·假设每个州中阿片类药物流行病的传播都有且只有一个源头，即该源头对其他地理区域（县）的影响最为显著，我们假设每个州内每年阿片类药物报告数量最多的县就是这个州内的源头
·假设地理区域（州、县）之间的传播强度不随时间的变化而变化
·阿片类药物流行病的传播效果需要一年时间完整体现于被传播的地理区域数据中，即以一年为周期进行传播强度的计算
·一个地理区域（州、县）内阿片类药物报告数的增长量在第一部分的求解中只由其他地理区域（州、县）引起，在第二部分求解即修正模型时，我们考虑一个地理区域（州、县）本身的社
会经济因素对其阿片类药物报告数的增长量的影响

变量描述

3模型的细节描述（第一部分）
传播过程中，直观上能够起作用的因素为时间和空间。故首先对数据进行时间的平稳性检验，以观察数据是否出现不稳定的变化，其次对其进行空间依赖性检验，以观察数据是否出现明显空间上的集聚性。所得结果显示总体上州县都保持稳定增长的状态，出现剧烈波动的状况可能性较小，而州县个体上可能存在不平稳性。地理位置上县与县之间呈现出地理集聚的现象，即某一县的毒品量大则意味着可能周边县毒品量也很大。
3.1时间平稳性检验
对于州、县的时间平稳性检验，主要基于单位根检验。首先对面板总体进行LLC(Levin-Lin-Ch test)单位根检验，随后对单个州、县进行ADF(Augment Dickey-Fuller test)，其中LLC单位根检验是以ADF在面板数据中的扩展。
ADF检验主要研究上一年的值对本年的增长量是否有显著影响，其代表的含义是数据是否会随着年度的变化产生剧烈波动。对于$t$年的数据，可以做如下回归：
$$\Delta X_t = \delta X_{t-1} \sum_{l=1}^{p} \beta_i \Delta X_{t-l} +beta t +\alpha +\epsilon_t$$
其中，$\Delta X_t = X_t - X_{t-1}$ 表示当年相对于上一年的增量，$t$代表年份，建立回归模型，$l$代表年份间隔，$1 <= l <= p_i$.原假设为：
\text{H}_0 : \delta = 0
即上一年的值对本年的增长量没有显著影响，时间序列是平稳的。为突出$\X_t$的影响，需要进行三次回归，逐步剔除$t$与常数项$\alpha$，每次回归一旦拒绝了原假设即代表时间序列是平稳的。
对原假设进行的检验一般采用$t$检验，但由于时间序列存在序列相关性，即$\text{Cov} (X_t, X_t-l)\neq 0$导致最小二乘估计量非有效，故对$t$统计量进行Newey-West修正，再进行检验。
而LLC检验是以同样的方式，并假设个体是同质性的，进行面板数据的ADF检验。
题中所给的数据检验结果见表

检验结果表中选取了三次回归中P_值最低的检验进行报告，而县级的数据截取了部分进行汇报。从中可以看出，在所给的8年的数据之中，5%的显著性水平的条件下，面板数据全局呈现显著的平稳性，面板的每个截面（州、县）大多数并没有通过平稳性检验。表明所给样本每个截面可能出现一定程度的序列相关性，呈现较为剧烈的波动状态，但面板的联合状况并没有出现激增、骤减的状况，维持在稳定的水平，各个截面之间可能存在协整关系，即截面与截面之间存在“此消彼长”的状况。除此之外，对于各个截面的带时间$t$的ADF检验中，我们发现大部分有增长趋势或毒品发现量很大的地点，时间趋势项前的系数大都通过了显著性水平为10%的检验。这也为我们在第一个问题中简化模型后，运用ARIMA时间序列预测传染源找到了合理的依据。

3.2空间依赖性检验
对于州、县之间空间位置的影响程度检验，主要基于莫兰I统计量，了解空间在多大程度上呈现集聚的状况。其具体检验步骤如下：
首先，计算空间距离权重矩阵$W$，$W=[w_{ij}]_{n×n} $w_ij$表示$ij$两个州或县之间标准化后的邻接状况。
由于行政区划上的邻接并未考虑实际地理距离，故假设30km为县之间的邻接状况，100km为州之间的邻接状况。未标准化的邻接状况为
$$
\bar{w_ij}=
\begin {cases}
1, &\ R_{ij}<=R_0 \\\
0, &\ R_{ij}>R_0
\end{cases}
$$
其中，R_{ij}表示$ij$两个州或县之间地理位置的距离，R_0表示设定为邻接的距离。据此可知：
$$w_{ij} = \frac{\bar{w_{ij}}}{\sum_{j=1}^{j=n} \bar{w_{ij}}$$
随后，计算莫兰I统计量
$$I=\frac{n\sum_i \sum_{j \neq i} w_{ij} (y_i - \bar{y})(y_j - \bar{y})}{(\sum_i \sum_{j\neq i}w_{ij})\sum_i (y_i - \bar(y))^2}$$
y_{ij}表示当地毒品报告数。I近似服从正态分布，可以对其进行显著性检验。根据题中数据，汇报结果如下表：


从结果中可以看出，县与县之间的莫兰I统计量在显著性水平为5%的情况下，显著大于0，即呈现出地理位置上的集聚性，但I并没有接近于1，地理位置上的集聚性并不明显。而州的个数太少，而呈现出不显著的分散状况。
3.3传播矩阵
为了描述多种因素对一个地理区域（州、县）对另一个地理区域（州、县）阿片类药物数量的影响，我们将其抽象为一个数学指标，称之为传播强度\beta_{ij}，继而我们构建一个传播
矩阵来描述多个地理区域之间阿片类药物数量的相互影响，从本质上讲，传播矩阵可以量化一个地理区域（州、县）的阿片类药物数量从一个时期到下一个时期如何传播：
公式（1）：矩阵相乘 t+1=传播矩阵 * t
其中T_it是i州（县）在t年内的阿片类药物报告数量，T_it+1是i州（县）在t+1年内阿片类药物报告数量，β_ij是i州（县）对j州（县）的传播强度
用向量形式并以多年分析有：
T_t+1 = B * T_t
T_t+2 = B * T_t+1
T_t+3 = B * T_t+2
...
T_t+p = B * T_t+p-1
其中矩阵B可由多年数据估计得到,在上式计算过程中，有：
E_ij = β_ij * T_it
E_ij是州（县）i对州（县）j的传播强度与州（县）i的第t年的阿片类药物报告数量的乘积，我们把它称之为有效传播数量，表示一年内一个地理区域（州、县）对另一个地理区域（州、县）
的具体有效影响数量，接着有：
T_j,t+1 = j从1到n相加 β_ij*Ti_t =j从1到n相加 E_ij
其中n是所有地理区域（州、县）的数量，上式说明一个地理区域（州、县）一年内的阿片类药物数量可由上一年其他所有已知地理区域（州、县）对它的有效传播数量累积求和计算求得

5模型的求解
5.1模型的简化
我们已有的数据是2010年到2017年各州（县）的阿片类药物报告总数，但要计算的传播矩阵中有n_2个未知数（n是州（县）的数量），而有效数据只有八年的数量，所以根据已有数据我们
无法估计出县与县之间有效的传播矩阵，所以我们对模型进行简化：
`在每个州内，每一年都有且只有一个阿片类药物流行病的源头
`每个州除源头之外的其他县的阿片类药物报告数量到下一年的增长量只受该年源头县的数量影响
`一个县一年内的阿片类药物数量增长量可由上一年的源头县对它的有效传播数量得到
由以上叙述有：
T_I,T+1 = △_i,t + T_i,T
△i,t = β_k,i * T_k,t
其中k是第t年的源头县，△_i,t是县i的阿片类药物报告数量从第t年到第t+1年的增长量，根据上式，我们通过简化模型大大缩减了计算式（2）所需的数据量
5.1传播矩阵的初始化
5.1.1州之间的传播矩阵
我们考虑到同州的两个县之间的传播强度和不同州的两个县之间的传播强度一般不同，所以在初始化县之间传播矩阵之前，我们首先计算州之间的传播矩阵，用来描述不同州的两个县之间的传播强度
第一，确定每一年的源头州，即每一年阿片类药物数量最多的州
第二，用已有数据求出每一年的阿片类药物报告数量的增长量，继而有
β_ijt = △i_t / T_kt
即通过每两年的数据可以计算出一个州之间的传播矩阵
第三，用已有的多年数据对州之间的传播矩阵进行修正，即:
β_ij_final = t从1到m求和 β_ijt / m
其中m是总年数，通过上式的修正即可求得州之间较为准确的传播矩阵
5.1.2初始化县之间的传播矩阵
在上述计算出的州之间的传播矩阵中，我们观察到州之间的传播强度都属于10^(-3)量级，显然，考虑到同州内的县之间的传播强度一般大于不同州的县之间的传播强度，所以我们对县之间的传播矩阵作以下初始化：
`对于同州内的不同县，将其传播强度初始化为一个定值α=0.01，属于10^(-2)量级，符合了上述题设要求
`对于不同州之间的不同县，将其传播强度定为县所属州之间的传播强度
5.2县之间传播矩阵的修正
由于州之间的传播矩阵是通过多年数据修正后的结果，为了让同州之间的不同县和不同州之间的不同县在修正过程中有同样的数据变化，让数据更加有效，我们将同州内的不同县之间的传播强度从0.01*m开始累加，修正过程如下：
β_ij_final = t从1到m求和 β_ijt / m
5.3预测
5.3.1下一年源头的预测
由于简化后的传播矩阵无法预测下一年的传染源头，故需要进行时间序列预测。我们采用ARIMA（Autoregressive Integrated Moving Average model）模型预测，基于4.1的检验，可以得知单个州或县的时间序列是非平稳但是协整的。故对单个州或县的时间序列做协整化处理：
首先，对总体的Y_t=\sum Y_{it} 进行检验，其通过了平稳性检验，且根据ADF检验的结果，每个检验变量的系数都通过了显著性检验，即有如下模型：
$$\hat{\Delta Y_t} = \alpha +\beta t-\gamma Y_{t-1}+\rho \Delta X_{t-1}$$
其每个参数都通过了显著性水平为5%的$t$检验，结果汇报见下表：

以此预测下一年的总量$\hat {Y_{t+1}}=\hat{\Delta Y_{t}}+Y_t$，也可以求得每一年的回归均值 E(Y_t |X)=\hat{\Delta Y_{t}+Y_{t-1}}
以总量减去其他县或州的残值作为$Y_it$的替代值：
$\bar{Y_{it}}=\hat{Y_t}-\sum_{j=1,j\neq i}^{n} Y_{jt}$
对变换后的$\bar{Y_{it}}$做平稳性检验，不平稳则取一阶差分，一阶差分不平稳则取二阶，以此类推。由于观测时间值的限制，差分无法无限制进行，最多取四阶差分，若依旧不能通过平稳性检验，则根据信息损耗最少的原则，直接以替代值直接进行下一步操作。
对上一步得到的数据进行偏自相关系数与自相关函数的识别，偏自相关系数截尾而自相关函数拖尾则建立AR模型，若偏相关函数是拖尾，自相关函数是截尾的则建立MA模型，若偏相关函数和自相关函数均为拖尾则建立ARMA模型，每种模型的基本设定如下：
自回归模型AR：
$\bar{Y_t}=c+\sum_{t=1}^p \theta_i \bar{Y_{t-i}+\varepsilon_t}$
移动平均模型MA：
$\bar{Y_t}=\mu+\sum_{t=1}^p \theta_i \varepsilon_{t-i}+\varepsilon_{t-i}$
ARMA模型：
$\bar{Y_t}=c+\sum_{t=1}^p \theta_i \bar{Y_{t-i}+\varepsilon_t}+\varphi_i \varepsilon_{t-i}$
对所有县或州进行回归预测，选取预测值最大的州或县作为“传染源”。
5.3.2预测
·用前一年的数据预测下一年的源头
·根据每年的源头计算出该年份到下一年的增长量
·基于前一年数据与增长量相加即可预测出每一年的数量
即如下：
T_I,T+1 = △_i,t + T_i,T
△i,t = β_k,i * T_k,t



模型的修正
模型应用
灵敏性分析
结论
优点和缺点
备忘录
附录
